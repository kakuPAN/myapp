<h1>タスク一覧</h1>
<div id="achievement-rate"><span id="ahievement-rate-label">現在のタスク達成率</span> <span id="achievement-rate-number"><%= @achievement %></span> % </div>
<div class="mb-3">
  <div class="row">
    <div class="col-lg-10 offset-lg-1">
      <%= render 'search_form', q: @q %>
    </div>
  </div>
</div>
<% if @tasks %>
  <% @tasks.each do |task| %>
    <% if (logged_in? && current_user.id == task.user_id) || task.public_access? %>
      <div class=" border border-primary">
        <p id="task-user-name">
          <%= User.find(task.user_id).user_name %>
        </p>
        <div class="task-index m-2">
          <% if logged_in? && current_user.id == task.user_id %>
            <%= link_to achieve_task_task_path(task.id), data: { turbo_method: :patch }, class: "task-title" do %>
              <% if task.done? %>
                <h3><i class="bi bi-circle-fill"></i></h3>
              <% else %>
                <h3><i class="bi bi-circle"></i></h3>
              <% end %>
            <% end %>
          <% end %>
        </div>
        <div class="task-index m-2">
          <%= link_to task_path(task.id), class: "task-title" do %>
            <h3>
              <%= task.title %>
            </h3>
          <% end %>
        </div>
        <span><<%= I18n.t("enums.task.progress_status.#{task.progress_status}") %>></span>
      </div>
    <% end %>
  <% end %>
<% else %>
  <p><%= current_user.user_name %>さまのタスクはありません</p>
<% end %>

<style>
  #achievement-rate {
    float: right;
    margin: 5px;
  }
  #achievement-rate-label {
    font-size: 12px;
  }
  #achievement-rate-number {
    font-size: 25px;
    font-weight: bold;
  }
  #task-user-name {
    margin:1px;
  }

</style>