<%= render "shared/goal_related_header" %>
<h1><%= @goal.title %></h1>
<h3>タスク一覧</h3>
<div class="mb-3">
  <div class="row">
    <div class="col-lg-10 offset-lg-1">
      <%= render "search_form", q: @q %>
    </div>
  </div>
</div>
<div class="whole-wrapper">
  <div class="scroll-area">
    <% if @tasks %>
      <% @tasks.each do |task| %>
        <div class="task-area border border-primary">
          <div class="task-index m-2">
            <% if logged_in? && current_user.id == task.user_id %>
              <%= link_to achieve_task_goal_task_path(@goal, task.id), data: { turbo_method: :patch }, class: "task-title" do %>
                <% if task.done? %>
                  <h3><i class="bi bi-circle-fill"></i></h3>
                <% else %>
                  <h3><i class="bi bi-circle"></i></h3>
                <% end %>
              <% end %>
            <% end %>
          </div>
          <div class="task-index m-2">
            <%= link_to goal_task_path(@goal,task.id), class: "task-title" do %>
              <h3>
                <%= task.title %>
              </h3>
            <% end %>
          </div>
          <span><%= I18n.t("enums.task.progress_status.#{task.progress_status}") %></span>
        </div>
      <% end %>
    <% else %>
      <p><%= current_user.user_name %>さまのタスクはありません</p>
    <% end %>
    <div class="pagination">
      <%= paginate @tasks, theme: "bootstrap-5", pagination_class: "pagination-lg" %>
    </div>
  </div>
  <div class="scroll-area">
    <div class="container">
      <% if @object_locations %>
        <% @object_locations.each do |ol| %>
          <%= image_tag "#{ol.city_object.object_image}", id: "object-location-#{ol.location.id}" %>
        <% end %>
      <% end %>
    </div>
  </div>
</div>
<!-- スクロール !-->
<style>
  body {
  }
  .whole-wrapper {
    overflow: auto;
    scroll-snap-type: y mandatory;
    height: 100vh;
  }
  .scroll-area {
    scroll-snap-align: start;
    height: 100vh;
  }
</style>
<!-- ページネーション !-->
<style>
  .pagination {
  justify-content: center;
  }
</style>

<style>
  .whole-wrapper {
    background-size: 1600px;
    background-repeat: no-repeat;
    background-position: 30% 10%;
    height: 900px;
  }
</style>

<!-- 以下、タスク一覧のスタイル !-->
<style>
  .task-area {
    background:rgba(255,255,255,0.7)
  }
  #achievement-rate {
    float: right;
    margin: 5px;
  }
  #achievement-rate-label {
    font-size: 12px;
  }
  #achievement-rate-number {
    font-size: 25px;
    font-weight: bold;
  }
  #task-user-name {
    margin:1px;
  }

</style>
